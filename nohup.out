OMP: Info #271: omp_set_nested routine deprecated, please use omp_set_max_active_levels instead.
/workspace/AMI/BA/dataproc.py:225: FutureWarning: Calling int on a single element Series is deprecated and will raise a TypeError in the future. Use int(ser.iloc[0]) instead
  for label in range(int(labels.max())+1):
/opt/conda/lib/python3.8/site-packages/sklearn/utils/validation.py:63: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  return f(*args, **kwargs)
/opt/conda/lib/python3.8/site-packages/sklearn/utils/validation.py:63: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  return f(*args, **kwargs)
/opt/conda/lib/python3.8/site-packages/sklearn/utils/validation.py:63: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  return f(*args, **kwargs)
/opt/conda/lib/python3.8/site-packages/sklearn/utils/validation.py:63: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  return f(*args, **kwargs)
/opt/conda/lib/python3.8/site-packages/sklearn/utils/validation.py:63: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  return f(*args, **kwargs)
/opt/conda/lib/python3.8/site-packages/sklearn/utils/validation.py:63: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  return f(*args, **kwargs)
/workspace/AMI/BA/dataproc.py:225: FutureWarning: Calling int on a single element Series is deprecated and will raise a TypeError in the future. Use int(ser.iloc[0]) instead
  for label in range(int(labels.max())+1):
/workspace/AMI/BA/pred_model.py:81: RuntimeWarning: divide by zero encountered in true_divide
  return np.mean(np.abs((y_true - y_pred) / y_true)) * 100
/workspace/AMI/BA/pred_model.py:81: RuntimeWarning: divide by zero encountered in true_divide
  return np.mean(np.abs((y_true - y_pred) / y_true)) * 100
self.data_train.shape:  (365, 42)
self.data_test.shape:  (202, 42)
DatetimeIndex(['2022-03-02', '2022-03-03', '2022-03-04', '2022-03-05',
               '2022-03-06', '2022-03-07', '2022-03-08', '2022-03-09',
               '2022-03-10', '2022-03-11',
               ...
               '2023-02-19', '2023-02-20', '2023-02-21', '2023-02-22',
               '2023-02-23', '2023-02-24', '2023-02-25', '2023-02-26',
               '2023-02-27', '2023-02-28'],
              dtype='datetime64[ns]', name='Time', length=364, freq=None)
DatetimeIndex(['2022-03-02', '2022-03-03', '2022-03-04', '2022-03-05',
               '2022-03-06', '2022-03-07', '2022-03-08', '2022-03-09',
               '2022-03-10', '2022-03-11',
               ...
               '2023-02-19', '2023-02-20', '2023-02-21', '2023-02-22',
               '2023-02-23', '2023-02-24', '2023-02-25', '2023-02-26',
               '2023-02-27', '2023-02-28'],
              dtype='datetime64[ns]', name='Time', length=364, freq=None)
DatetimeIndex(['2022-03-02', '2022-03-03', '2022-03-04', '2022-03-05',
               '2022-03-06', '2022-03-07', '2022-03-08', '2022-03-09',
               '2022-03-10', '2022-03-11',
               ...
               '2023-02-19', '2023-02-20', '2023-02-21', '2023-02-22',
               '2023-02-23', '2023-02-24', '2023-02-25', '2023-02-26',
               '2023-02-27', '2023-02-28'],
              dtype='datetime64[ns]', name='Time', length=364, freq=None)
DatetimeIndex(['2022-03-02', '2022-03-03', '2022-03-04', '2022-03-05',
               '2022-03-06', '2022-03-07', '2022-03-08', '2022-03-09',
               '2022-03-10', '2022-03-11',
               ...
               '2023-02-19', '2023-02-20', '2023-02-21', '2023-02-22',
               '2023-02-23', '2023-02-24', '2023-02-25', '2023-02-26',
               '2023-02-27', '2023-02-28'],
              dtype='datetime64[ns]', name='Time', length=364, freq=None)
data_train_augmented.shape:  (1821, 42)
SelctedFeaturesSrt:  ['dc10LmcsCa', 'vs', 'ts', 'day_month_x', 'day_month_y', 'day_year_x', 'month_x', 'month_y', 'day__0', 'day__1', 'day__2', 'day__4', 'day__5', 'weekdays', 'wd_x', 'wd_y', 'power_yesterday', 'power_ema4', 'power_ema7', 'power_ema14']
opt_n_estimators,opt_max_depth,opt_learning_rate:  (100, 5, 0.1)
[0.00305448 0.00378341 0.00970312 0.04663792 0.0044504  0.00686559
 0.08441447 0.00183356 0.00219989 0.00428167 0.00457562 0.0059915
 0.00240968 0.78902966 0.00491656 0.00270986 0.01833333 0.00158491
 0.00163673 0.00158764]
opt_n_estimators,opt_max_depth,opt_learning_rate:  (100, 5, 0.1)
[0.00452716 0.00558336 0.04994186 0.01470452 0.009003   0.02991289
 0.04277485 0.03045037 0.03805484 0.01318992 0.00435406 0.02493034
 0.03084298 0.40442926 0.01211656 0.00861127 0.23717195 0.01465039
 0.01422859 0.01052188]
opt_n_estimators,opt_max_depth,opt_learning_rate:  (100, 5, 0.1)
[1.3172311e-03 5.9859973e-01 1.0472219e-03 1.4658954e-03 0.0000000e+00
 0.0000000e+00 0.0000000e+00 0.0000000e+00 1.7809796e-03 0.0000000e+00
 0.0000000e+00 0.0000000e+00 5.4221205e-06 2.2093046e-03 3.7044621e-01
 2.0418297e-02 6.3056580e-04 6.6681590e-04 2.6110109e-04 1.1512378e-03]
Fold 1: Accuracy = 0.7233
Fold 2: Accuracy = 0.6951
Fold 3: Accuracy = 0.7170
Fold 4: Accuracy = 0.7225
Fold 5: Accuracy = 0.7143
Mean Accuracy: 0.7144
OMP: Info #271: omp_set_nested routine deprecated, please use omp_set_max_active_levels instead.
/workspace/AMI/BA/dataproc.py:230: FutureWarning: Calling int on a single element Series is deprecated and will raise a TypeError in the future. Use int(ser.iloc[0]) instead
  for label in range(int(labels.max())+1):
/opt/conda/lib/python3.8/site-packages/sklearn/utils/validation.py:63: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  return f(*args, **kwargs)
/opt/conda/lib/python3.8/site-packages/sklearn/utils/validation.py:63: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  return f(*args, **kwargs)
/opt/conda/lib/python3.8/site-packages/sklearn/utils/validation.py:63: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  return f(*args, **kwargs)
/opt/conda/lib/python3.8/site-packages/sklearn/utils/validation.py:63: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  return f(*args, **kwargs)
/opt/conda/lib/python3.8/site-packages/sklearn/utils/validation.py:63: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  return f(*args, **kwargs)
/opt/conda/lib/python3.8/site-packages/sklearn/utils/validation.py:63: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  return f(*args, **kwargs)
/workspace/AMI/BA/dataproc.py:230: FutureWarning: Calling int on a single element Series is deprecated and will raise a TypeError in the future. Use int(ser.iloc[0]) instead
  for label in range(int(labels.max())+1):
/workspace/AMI/BA/pred_model.py:80: RuntimeWarning: divide by zero encountered in true_divide
  return np.mean(np.abs((y_true - y_pred) / y_true)) * 100
/workspace/AMI/BA/pred_model.py:80: RuntimeWarning: divide by zero encountered in true_divide
  return np.mean(np.abs((y_true - y_pred) / y_true)) * 100
label
0        1295
1         466
Name: count, dtype: int64
opt_n_estimators,opt_max_depth,opt_learning_rate:  (200, 5, 0.05)
[0.00442159 0.00502354 0.14257775 0.01366549 0.02724574 0.03154336
 0.03971111 0.02563187 0.0237838  0.01521275 0.00711889 0.00649115
 0.02747814 0.502204   0.01175111 0.00922949 0.07182359 0.01210928
 0.01304951 0.00992791]
opt_n_estimators,opt_max_depth,opt_learning_rate:  (200, 5, 0.05)
[0.0057095  0.00264967 0.00971413 0.04808669 0.010348   0.00508001
 0.0560892  0.00621234 0.00477525 0.00665252 0.00230305 0.016586
 0.00151785 0.8032692  0.00284857 0.00187119 0.00973968 0.00258986
 0.00135556 0.00260176]
Fold 1: Accuracy = 0.7224
Fold 2: Accuracy = 0.7386
Fold 3: Accuracy = 0.7159
Fold 4: Accuracy = 0.7500
Fold 5: Accuracy = 0.7500
Mean Accuracy: 0.7354
{'MAE': 237.95180660617157, 'RMSE': 320.1875724277685, 'MAPE': inf}
OMP: Info #271: omp_set_nested routine deprecated, please use omp_set_max_active_levels instead.
/workspace/AMI/BA/dataproc.py:230: FutureWarning: Calling int on a single element Series is deprecated and will raise a TypeError in the future. Use int(ser.iloc[0]) instead
  for label in range(int(labels.max())+1):
/opt/conda/lib/python3.8/site-packages/sklearn/utils/validation.py:63: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  return f(*args, **kwargs)
/opt/conda/lib/python3.8/site-packages/sklearn/utils/validation.py:63: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  return f(*args, **kwargs)
/opt/conda/lib/python3.8/site-packages/sklearn/utils/validation.py:63: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  return f(*args, **kwargs)
/opt/conda/lib/python3.8/site-packages/sklearn/utils/validation.py:63: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  return f(*args, **kwargs)
/opt/conda/lib/python3.8/site-packages/sklearn/utils/validation.py:63: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  return f(*args, **kwargs)
/opt/conda/lib/python3.8/site-packages/sklearn/utils/validation.py:63: DataConversionWarning: A column-vector y was passed when a 1d array was expected. Please change the shape of y to (n_samples, ), for example using ravel().
  return f(*args, **kwargs)
/workspace/AMI/BA/dataproc.py:230: FutureWarning: Calling int on a single element Series is deprecated and will raise a TypeError in the future. Use int(ser.iloc[0]) instead
  for label in range(int(labels.max())+1):
/workspace/AMI/BA/pred_model.py:80: RuntimeWarning: divide by zero encountered in true_divide
  return np.mean(np.abs((y_true - y_pred) / y_true)) * 100
/workspace/AMI/BA/pred_model.py:80: RuntimeWarning: divide by zero encountered in true_divide
  return np.mean(np.abs((y_true - y_pred) / y_true)) * 100
self.data_train.shape:  (365, 42)
self.data_test.shape:  (187, 42)
DatetimeIndex(['2022-03-17', '2022-03-18', '2022-03-19', '2022-03-20',
               '2022-03-21', '2022-03-22', '2022-03-23', '2022-03-24',
               '2022-03-25', '2022-03-26',
               ...
               '2023-02-19', '2023-02-20', '2023-02-21', '2023-02-22',
               '2023-02-23', '2023-02-24', '2023-02-25', '2023-02-26',
               '2023-02-27', '2023-02-28'],
              dtype='datetime64[ns]', name='Time', length=349, freq=None)
DatetimeIndex(['2022-03-17', '2022-03-18', '2022-03-19', '2022-03-20',
               '2022-03-21', '2022-03-22', '2022-03-23', '2022-03-24',
               '2022-03-25', '2022-03-26',
               ...
               '2023-02-19', '2023-02-20', '2023-02-21', '2023-02-22',
               '2023-02-23', '2023-02-24', '2023-02-25', '2023-02-26',
               '2023-02-27', '2023-02-28'],
              dtype='datetime64[ns]', name='Time', length=349, freq=None)
DatetimeIndex(['2022-03-17', '2022-03-18', '2022-03-19', '2022-03-20',
               '2022-03-21', '2022-03-22', '2022-03-23', '2022-03-24',
               '2022-03-25', '2022-03-26',
               ...
               '2023-02-19', '2023-02-20', '2023-02-21', '2023-02-22',
               '2023-02-23', '2023-02-24', '2023-02-25', '2023-02-26',
               '2023-02-27', '2023-02-28'],
              dtype='datetime64[ns]', name='Time', length=349, freq=None)
DatetimeIndex(['2022-03-17', '2022-03-18', '2022-03-19', '2022-03-20',
               '2022-03-21', '2022-03-22', '2022-03-23', '2022-03-24',
               '2022-03-25', '2022-03-26',
               ...
               '2023-02-19', '2023-02-20', '2023-02-21', '2023-02-22',
               '2023-02-23', '2023-02-24', '2023-02-25', '2023-02-26',
               '2023-02-27', '2023-02-28'],
              dtype='datetime64[ns]', name='Time', length=349, freq=None)
data_train_augmented.shape:  (1761, 42)
SelctedFeaturesSrt:  ['vs', 'ts', 'day_month_x', 'day_month_y', 'day_year_x', 'month_x', 'month_y', 'day__0', 'day__1', 'day__2', 'day__3', 'day__4', 'day__5', 'weekdays', 'wd_x', 'wd_y', 'power_yesterday', 'power_ema4', 'power_ema7', 'power_ema14']
label
0        1295
1         466
Name: count, dtype: int64
opt_n_estimators,opt_max_depth,opt_learning_rate:  (300, 5, 0.1)
[0.00340963 0.03785065 0.00879778 0.01136485 0.02443162 0.02886263
 0.01971781 0.03770795 0.01182406 0.0034722  0.00544495 0.01334815
 0.03099418 0.6310273  0.00688708 0.00682802 0.09888892 0.006153
 0.00693258 0.00605663]
opt_n_estimators,opt_max_depth,opt_learning_rate:  (300, 5, 0.05)
[1.9112001e-03 4.6383678e-03 3.5431750e-02 5.9011187e-03 3.2118682e-03
 4.6921682e-02 1.8609846e-03 1.6564117e-03 5.0581461e-03 1.9402548e-03
 4.0257564e-03 8.0076233e-03 5.1003695e-04 8.5930920e-01 1.9418756e-03
 1.6945363e-03 1.1275813e-02 1.8938931e-03 1.0402964e-03 1.7691579e-03]
Fold 1: Accuracy = 0.7224
Fold 2: Accuracy = 0.7386
Fold 3: Accuracy = 0.7159
Fold 4: Accuracy = 0.7500
Fold 5: Accuracy = 0.7500
Mean Accuracy: 0.7354
{'MAE': 228.994503210272, 'RMSE': 312.91465646693626, 'MAPE': inf}
